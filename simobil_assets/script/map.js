function initAutocomplete(){$(function(){$("#map-search").autocomplete({source:function(n,t){geocoder==null&&(geocoder=new google.maps.Geocoder),geocoder.geocode({address:n.term+", Slovenija"},function(n,i){i==google.maps.GeocoderStatus.OK&&t($.map(n,function(n){return{label:n.formatted_address,value:n.formatted_address,bounds:n.geometry.bounds}}))})},select:function(n,t){var r=t.item.position,u=t.item.locType,i=t.item.bounds;i&&map.fitBounds(i),map.setZoom(11)}})}),$("#map-search").keyup(function(n){n.keyCode==13&&codeAddress()})}function checkParameters(){if(QueryString.m!=undefined)switch(QueryString.m){case"1":selectCoverage("GSMSQL","#GSMT"),wmslayer="GSMSQL";break;case"2":selectCoverage("UMTSSQL","#UMTST"),wmslayer="UMTSSQL";break;case"3":selectCoverage("LTESQL","#LTET"),wmslayer="LTESQL"}}function codeAddress(){var n=document.getElementById("map-search").value+", Slovenija";geocoder.geocode({address:n},function(n,t){t==google.maps.GeocoderStatus.OK&&(map.setCenter(n[0].geometry.location),map.setZoom(11),document.getElementById("map-search").blur(),document.getElementById("map-search").focus())})}function setOverlay(n){if(wmslayer=n,n!=""){var t=new google.maps.LatLngBounds(new google.maps.LatLng(45.38,13.35),new google.maps.LatLng(46.9,16.61)),i=imageserver+"wms"+n+".png";imgoverlay!=null&&imgoverlay.setMap(null),imgoverlay=new google.maps.GroundOverlay(i,t),zoomLevel=map.getZoom(),zoomLevel<11?(map.overlayMapTypes.getLength()>0&&map.overlayMapTypes.setAt(0,null),imgoverlay.setMap(map)):(imgoverlay.setMap(null),map.overlayMapTypes.getLength()>0&&map.overlayMapTypes.setAt(0,null),loadWMS(map,wmsserver,n))}}function selectCoverage(n){setOverlay(n)}function setDefaultView(){$('.filter-controls h6.active').removeClass('active');wmslayer="",initialLocation=new google.maps.LatLng(46.15,15),map.setCenter(initialLocation),map.setZoom(8),map.overlayMapTypes.getLength()>0&&map.overlayMapTypes.setAt(0,null),imgoverlay!=null&&imgoverlay.setMap(null)}function bound(n,t,i){return t!=null&&(n=Math.max(n,t)),i!=null&&(n=Math.min(n,i)),n}function degreesToRadians(n){return n*(Math.PI/180)}function radiansToDegrees(n){return n/(Math.PI/180)}function MercatorProjection(){this.pixelOrigin_=new google.maps.Point(MERCATOR_RANGE/2,MERCATOR_RANGE/2),this.pixelsPerLonDegree_=MERCATOR_RANGE/360,this.pixelsPerLonRadian_=MERCATOR_RANGE/(2*Math.PI)}function loadWMS(n,t,i){var r=256,u=256,f=t,e=["REQUEST=GetMap","SERVICE=WMS","VERSION=1.3.0","BGCOLOR=0xFFFFFF","TRANSPARENT=TRUE","CRS=EPSG:4326","WIDTH="+u,"HEIGHT="+r],o=e.concat(["FORMAT=image/png","LAYERS="+i,"STYLES=","OPACITY=60"]),s={getTileUrl:function(n,t){var e=new google.maps.Point(n.x*256,(n.y+1)*256),s=new google.maps.Point((n.x+1)*256,n.y*256),i=new MercatorProjection,r=i.fromDivPixelToLatLng(e,t),u=i.fromDivPixelToLatLng(s,t),h=r.lat(),c=r.lng()+.0043,l=u.lat(),a=u.lng()+.0043;return f+o.join("&")+"&bbox="+c+","+h+","+a+","+l},tileSize:new google.maps.Size(r,u),minZoom:2,maxZoom:28,opacity:1,isPng:!0};overlayWMS=new google.maps.ImageMapType(s),n.overlayMapTypes.push(null),n.overlayMapTypes.insertAt(0,overlayWMS)}var map,geocoder,wmsserver="http://wsmap.simobil.si/wms/wms.ashx?",imageserver="http://wsmap.simobil.si/simobilMMap/images/",wmslayer="",imgoverlay,MERCATOR_RANGE,QueryString;$(document).ready(function(){var n={key:"ABQIAAAAn5wMxXyLjrufxBC7xN6kqhTx1xlImrMOFxnB--T8o-3r0b6O_BRHEPfJmyBhLtwQktRzvyGc3lmkFw",zoom:8,minZoom:7,maxZoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1,panControl:!0,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},scaleControl:!0,center:new google.maps.LatLng(46.15,15)};google.maps.visualRefresh=!0,map=new google.maps.Map(document.getElementById("googlemap"),n),google.maps.event.addListener(map,"zoom_changed",function(){setOverlay(wmslayer)}),checkParameters(),geocoder=new google.maps.Geocoder,initAutocomplete()}),MERCATOR_RANGE=256,MercatorProjection.prototype.fromLatLngToPoint=function(n,t){var i=this,r=t||new google.maps.Point(0,0),f=i.pixelOrigin_,u;return r.x=f.x+n.lng()*i.pixelsPerLonDegree_,u=bound(Math.sin(degreesToRadians(n.lat())),-.9999,.9999),r.y=f.y+.5*Math.log((1+u)/(1-u))*-i.pixelsPerLonRadian_,r},MercatorProjection.prototype.fromDivPixelToLatLng=function(n,t){var i=this,r=i.pixelOrigin_,u=Math.pow(2,t),f=(n.x/u-r.x)/i.pixelsPerLonDegree_,e=(n.y/u-r.y)/-i.pixelsPerLonRadian_,o=radiansToDegrees(2*Math.atan(Math.exp(e))-Math.PI/2);return new google.maps.LatLng(o,f)},MercatorProjection.prototype.fromDivPixelToSphericalMercator=function(n,t){var f=this,i=f.fromDivPixelToLatLng(n,t),r=6378137,e=r*degreesToRadians(i.lng()),u=degreesToRadians(i.lat()),o=r/2*Math.log((1+Math.sin(u))/(1-Math.sin(u)));return new google.maps.Point(e,o)},QueryString=function(){for(var t={},f=window.location.search.substring(1),r=f.split("&"),n,u,i=0;i<r.length;i++)n=r[i].split("="),typeof t[n[0]]=="undefined"?t[n[0]]=n[1]:typeof t[n[0]]=="string"?(u=[t[n[0]],n[1]],t[n[0]]=u):t[n[0]].push(n[1]);return t}();$().ready(function(){$('.coverage-map .filter-controls .item h6').click(function(){$(this).parents('.filter-controls').find('h6').removeClass('active');$(this).addClass('active');});});
